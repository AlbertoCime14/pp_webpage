<!DOCTYPE html>
<html>
<head>
  <title></title>
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script type="text/javascript" src="https://www.amcharts.com/lib/3/amcharts.js"></script>
  <script type="text/javascript" src="https://www.amcharts.com/lib/3/serial.js"></script>
  <script type="text/javascript" src="https://www.amcharts.com/lib/3/themes/light.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
  <link rel="stylesheet" href="../src/index.css" />
  <style type="text/css">
  .amcharts-axis-label{
    font-family: "Barlow-Regular";
    font-size: 14px;
  }

  #chartdiv {  
    width: 100%;
    max-height: 800px;
    height: 100vh;
  }
  </style>

</head>
<body>
<div class="container">
    <div id="chartdiv"></div>  
</div>

</body>
<script type="text/javascript">
  var data = [
{'category': 'No apta-1','name_fr':'No apta','date':'Norte II, CAMP (2015)','Décile 1':880, "color":"#40520f"},
{'category': 'No apta-2','name_fr':'No apta','date':'Norte II, CAMP  (2015)','Décile 1':856,"color":"#40520f"},
{'category': 'No apta-3','name_fr':'No apta','date':'Zacatal, CAMP (2015)','Décile 1':677,"color":"#40520f"},
{'category': 'No apta-4','name_fr':'No apta','date':'Manigua, CAMP (2015)','Décile 1':464,"color":"#40520f"},

{'category': 'Apta-5','name_fr':'Apta','date':'Chicxulub, YUC (2016)','Décile 1':170,"color":"#9fce21"},
{'category': 'Apta-6','name_fr':'Apta','date':'Norte II, YUC (2017)','Décile 1':161,"color":"#9fce21"},
{'category': 'Apta-7','name_fr':'Apta','date':'Tortugas, Q. ROO (2017)','Décile 1':140,"color":"#9fce21"},
{'category': 'Apta-8','name_fr':'Apta','date':'Niño P. Juarez, Q. ROO (2018)','Décile 1':114,"color":"#9fce21"},
{'category': 'Apta-9','name_fr':'Apta','date':'Progreso I, YUC (2017)','Décile 1':105,"color":"#9fce21"},
{'category': 'Apta-10','name_fr':'Apta','date':'Langosta, Q. ROO (2018)','Décile 1':94,"color":"#9fce21"}
];

let byName = _.groupBy(data, "name_fr");
let guides = _.map(byName, function(items, key) {
    return {
        "category": _.first(items).category,
        "toCategory": _.last(items).category,
        "lineAlpha": 0,
        "expand": true,
        "label": key,
        "labelRotation": 0,
        "tickLength": 80
    };
});

var chart = AmCharts.makeChart("chartdiv", {
    "hideCredits":true,
    "type": "serial",
    "graphs": [
        {
            "type": "column",
            "fillAlphas": 1,
            "title": "Décile 1",
            "valueField": "Décile 1",
            "colorField":"color",
            "lineColor":"FFFFFF"
        }/*,
        {
            "type": "column",
            "fillAlphas": .9,
            "title": "Décile 5",
            "valueField": "Décile 5"
        },
        {
            "type": "column",
            "fillAlphas": .9,
            "title": "Décile 9",
            "valueField": "Décile 9"
        }*/
    ],
    "columnSpacing": 1,
    "valueAxes": [
        {
            "position": "left",
            "title": ""
        }
    ],
    /*"legend": {
        "useGraphSettings": true,
        "position": "top",
        "align": "center"
    },*/
    "categoryField": "category",
    "categoryAxis": {
        "gridAlpha": 0,
        "labelRotation": 90,
        "guides": guides,
        "labelFunction": function(label, item) {
            return item.dataContext.date;
        }
    },
    "dataProvider": data
    
});

var panelsSettings = new AmCharts.PanelsSettings();
panelsSettings.fontFamily = "Barlow-Regular";
chart.panelsSettings = panelsSettings;

</script>
</html>